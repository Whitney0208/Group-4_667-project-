# Longitudinal Modeling of 30-Day Hospital Readmission Among Adults With Diabetes

Authors: Zhangziyan Jiang, Wanbing Wang, Xiaochen Zhou, Muyao Tang, Danni Liu  
Project type: BIOS 667 – Generalized Linear Models / longitudinal data analysis course project

---

## Overview

This repository contains the full analysis and report for a longitudinal study of 30-day hospital readmission among adults with diabetes. Using encounter-level electronic health record (EHR) data, we:

- Construct a longitudinal cohort with multiple inpatient encounters per patient.  
- Quantify how 30-day readmission risk evolves over repeated encounters.  
- Assess whether trajectories differ by insulin treatment regimen (No, Steady, Up, Down).  
- Compare alternative modeling strategies for correlated binary outcomes, including marginal GLMs and mixed-effects models.  
- Select and interpret a final random-slope GLMM as the primary inferential model.

The main manuscript is written in Quarto and rendered both to PDF and HTML.

---

## Repository structure

Key files in the root directory:

- `Longitudinal Modeling of 30-Day Hospital Readmission Among Adults With Diabetes.qmd`  
  Main Quarto source file for the manuscript. Contains data preprocessing, model fitting, diagnostics, and narrative text.

- `Longitudinal Modeling of 30-Day Hospital Readmission Among Adults With Diabetes.pdf`  
  Compiled PDF version of the manuscript suitable for submission or printing.

- `Longitudinal Modeling of 30-Day Hospital Readmission Among Adults With Diabetes.html`  
  Compiled HTML version of the manuscript for interactive viewing.

- `cleaned_diabetes_longitudinal_Nov29.csv`  
  Analysis-ready longitudinal dataset at the encounter level (one row per encounter). Includes patient identifiers, encounter index, 30-day readmission indicator, insulin regimen, demographics, and utilization variables.

- `variable_definitions_table.csv`  
  Data dictionary describing each analytic variable and its coding.

- `diabetic_data.csv`  
  Original raw dataset (not used directly in the main models; kept for reproducibility).

- `667_Group4_files/`  
  Support files generated by Quarto/R during rendering (figures, cache objects, etc.).

Other auxiliary files (e.g., `.Rhistory`, log and TeX files) are local artifacts of the analysis environment and can be safely ignored for interpretation.

---

## Analysis summary

### Outcome and covariates

- **Outcome:** 30-day readmission indicator (`readmit30`, 1 = readmitted within 30 days, 0 = not readmitted).  
- **Key exposure:** Insulin regimen during the encounter (`insulin`: No, Steady, Up, Down).  
- **Time index:** Truncated encounter index (1–5), representing visit order; centered version used in GLMMs.  
- **Adjustment variables:** Age group, gender, race, admission type, length of stay, number of medications, number of prior emergency visits, number of prior inpatient visits.

### Modeling strategy

1. **Marginal logistic GLM (independence working model)**  
   - Models encounter-level probability of 30-day readmission using a logit link.  
   - Includes truncated encounter index to capture time trends.  
   - Tests and retains an Insulin × Time interaction to allow regimen-specific trajectories.  
   - Uses cluster-robust (sandwich) standard errors to account for within-patient correlation.

2. **Generalized Linear Mixed Models (GLMMs)**  
   - Random-intercept GLMM with and without Insulin × Time interaction.  
   - Random-intercept-and-slope GLMM (`m3`) allowing both baseline risk and time slopes to vary by patient.  
   - Model comparison via AIC and likelihood-ratio tests shows that the random-slope specification with Insulin × Time provides the best fit.

3. **Marginal vs. conditional effects**  
   - Uses Zeger’s attenuation method to translate subject-specific GLMM coefficients into approximate population-averaged effects.  
   - Finds that conditional and approximate marginal odds ratios are very similar, indicating robust conclusions across modeling frameworks.

### Key findings

- Overall 30-day readmission is common in this cohort of adults with diabetes.  
- For patients not treated with insulin, readmission risk declines substantially with successive encounters, suggesting stabilization or a “learning” effect.  
- For patients undergoing insulin intensification (“Insulin Up”), trajectories are markedly flatter: their risk starts higher and decreases more slowly over time, even after adjusting for prior utilization and other covariates.  
- Approximately 11% of the variability in readmission risk is attributable to between-patient heterogeneity (intraclass correlation ≈ 0.11).  
- The random-slope GLMM captures clinically meaningful heterogeneity in both baseline risk and recovery rates and is used as the primary model for interpretation, with the robust GLM serving as a complementary marginal analysis.

---

## Reproducing the analysis

### Software requirements

- **R** ≥ 4.3  
- **Quarto** ≥ 1.3

Required R packages (as used in the `.qmd` file):

- Data manipulation & plotting: `tidyverse`, `dplyr`, `ggplot2`, `scales`  
- Regression & inference: `broom`, `broom.mixed`, `car`, `sandwich`, `lmtest`  
- Model diagnostics: `ResourceSelection`, `pROC`, `performance`  
- Mixed models & correlated data: `lme4`, `geepack`  
- Reporting: `knitr`, `kableExtra`, `gridExtra`

Install missing packages in R as needed, e.g.:

```r
packages <- c(
  "tidyverse", "broom", "broom.mixed", "car", "sandwich", "lmtest",
  "ResourceSelection", "pROC", "performance", "lme4", "geepack",
  "knitr", "kableExtra", "gridExtra", "scales"
)
install.packages(setdiff(packages, installed.packages()[, "Package"]))
```

### Rendering the manuscript

From the project root directory, run (in a terminal with Quarto on the `PATH`):

```bash
quarto render "Longitudinal Modeling of 30-Day Hospital Readmission Among Adults With Diabetes.qmd"
```

This will regenerate the HTML and PDF versions of the manuscript using the local R installation and the `.csv` data files in the repository.

---

## How to use this repository as a template

If you are working on a similar project (e.g., another BIOS 667/GLMM assignment), this repository illustrates:

- How to organize a longitudinal analysis around a single Quarto document.  
- How to structure the Model section to contrast GLM vs. GLMM approaches.  
- How to integrate diagnostics, model comparison, and interpretation in a cohesive report.  
- How to separate cleaned analysis data (`cleaned_diabetes_longitudinal_Nov29.csv`) from raw input (`diabetic_data.csv`) and document variables via a data dictionary.

You can adapt the directory structure and Quarto workflow to your own datasets and research questions.

---

## Git & GitHub workflow (brief)

To push this project to a GitHub repository (e.g., `https://github.com/Whitney0208/Group-4_667-project-`), the basic workflow from the project root is:

```bash
# 1. Initialize git (only once)
git init

# 2. Add the remote (replace URL if needed)
git remote add origin https://github.com/Whitney0208/Group-4_667-project-.git

# 3. Stage files for the initial commit
git add .

# 4. Commit
git commit -m "Initial commit: longitudinal modeling of 30-day readmission"

# 5. Set the main branch and push
git branch -M main
git push -u origin main
```

You may want to add a `.gitignore` file (not provided here) to exclude local artifacts such as `.Rhistory`, intermediate log/TeX files, and large cache directories, depending on your storage and privacy requirements.

